# dmarc-analyzer

Dmarc report analyzer

example.com!example.org!1475712000!1475798400.xml.gz

Issuer - Domain - start - end

dmarc_reports:
- id : autogenerated
- name : file name
- report_id : report_metadata > report_id
- issuer : issuer domain - name of the file
- org_name : report_metadata > org_name
- email : report_metadata > email
- start_date : report_metadata > date_range > begin
- end_date : report_metadata > date_range > end

dmarc_policy:
- id : autogenerated
- report_id : dmarc_reports.id
- domain 
- policy  (p: none, quarantine, reject)
- subdomain_policy (sp: none, quarantine, reject)
- alignement_dkim (adkim)
- alignement_spf (aspf)
- percentage (pct)
- failure_option (fo)

dmarc_source:
- id
- report_id
- source_ip
- count
- header_from
- enveloppe_from

dmarc_auth_results:
- id
- source_id
- spf_result : Result of the SPF check (pass, fail).
- dkim_result : Result of the DKIM check (pass, fail).
- spf_aligned : Whether SPF is aligned with the domain (true, false).
- dkim_aligned : Whether DKIM is aligned with the domain (true, false).

dmarc_policy_evaluated: 
- id
- source_id
- disposition : Action taken (none, quarantine, reject).
- reason : Additional reason or context for the disposition.